!function t(e,n,s){function r(i,a){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!a&&c)return c(i,!0);if(o)return o(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[i]={exports:{}};e[i][0].call(u.exports,function(t){var n=e[i][1][t];return r(n?n:t)},u,u.exports,t,e,n,s)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<s.length;i++)r(s[i]);return r}({1:[function(t){"use strict";t("./../common/directives/post.js"),t("./../common/directives/tagInput.js"),t("./../common/filters/filters.js"),t("./../common/models/postsService.js"),t("./../common/models/sessionService.js"),t("./../common/models/adminDataService.js"),t("./../adm/posts/module.js"),t("./../adm/users/module.js"),t("./../adm/redirects/module.js"),angular.module("ADM",["ngRoute","APSvcSession","ADMPosts","ADMUsers","ADMRedirects"]).config(["$locationProvider","$routeProvider",function(t){t.html5Mode(!0)}]).run(["$rootScope","$location","SessionService",function(t,e,n){n.onAuthenticated(function(){})}])},{"./../adm/posts/module.js":4,"./../adm/redirects/module.js":6,"./../adm/users/module.js":8,"./../common/directives/post.js":10,"./../common/directives/tagInput.js":13,"./../common/filters/filters.js":14,"./../common/models/adminDataService.js":15,"./../common/models/postsService.js":16,"./../common/models/sessionService.js":17}],2:[function(t,e){e.exports='<article itemscope="itemscope" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">\n <header class="entry-header">\n    <img class="entry-header-image" itemprop="image" ng-src="{{ post.meta.ogImage }}" align="left" />\n\n    <span class="entry-categories">\n      <a ng-repeat=\'tag in post.tags\' href="#" title="View all posts in {{ tag.name }}" rel="category tag">{{ \'{\'+tag.slug+\'}\' }}</a>\n    </span>\n\n    <p class="entry-meta">\n      <span class="entry-author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">\n        <span class="entry-author-name" itemprop="name">{{ post.by.name }}</span>\n      </span>\n    <img class="entry-author-image" itemprop="image" ng-src="{{ post.by.avatar }}?s=50" align="left" />\n      <br />Updated\n      {{ post.updated | agoTime }}\n      <span ng-if="post.published">,\n      Published {{ post.published | agoTime }}</span>\n      <time class="entry-time" itemprop="datePublished" datetime="{{ post.published }}">{{ post.publishedFormat }}</time>\n    </p>\n  </header>\n  <div class="entry-content" itemprop="text">\n    <h2 class="entry-title" itemprop="headline">{{ post.title }}</h2>\n    <p>{{ post.meta.description }}</p>\n  </div>\n\n  <footer class="entry-footer" style="width:50%">\n    <ul>\n      <li><a href="/posts/edit/{{ post._id }}" target="_blank">Edit</a></li>\n      <li><a href="/posts/publish/{{ post._id }}" target="_blank">Publish</a></li>\n      <li ng-if="post.published"><a href="{{ post.url }}" target="_blank">View</a></li>\n    </ul>\n\n    <p class="entry-meta">\n\n    </p>\n  </footer>\n</article>\n'},{}],3:[function(t,e){e.exports='<section id="posts">\n\n  <h3>Recently updated <span><a href="/posts/all" target="_blank">All posts</a></span></h3>\n  <div class="posts recent">\n    <ap-post-list-item post="p" ng-repeat="p in recent"></ap-post-list-item>\n  </div>\n\n</section>\n'},{}],4:[function(t){"use strict";angular.module("ADMPosts",["ngRoute","APSvcAdmin","APSvcPosts","APFilters"]).config(["$locationProvider","$routeProvider",function(e,n){n.when("/v1/adm/posts",{template:t("./list.html"),controller:"PostsCtrl as posts"})}]).directive("apPostListItem",["$parse",function(){return{template:t("./item.html"),link:function(t,e,n){t.post=t.$eval(n.post)}}}]).controller("PostsCtrl",["$scope","PostsService","AdmDataService",function(t,e,n){n.getPosts(function(e){t.recent=e})}])},{"./item.html":2,"./list.html":3}],5:[function(t,e){e.exports='<section id="redirects">\n\n  <h3>Redirects </h3>\n\n  <div style="float:right">note a restart is necessary for the redirects to take effect</div>\n\n  <input type="text" ng-model=\'previous\' placeholder="From" />\n  <input type="text" ng-model=\'current\' placeholder="To" />\n  <select type="text" ng-model=\'type\' placeholder="RedirectType">\n    <option>301</option>\n    <option>302</option>\n    <option>410</option>\n  </select>\n  <button id="btnCreateRedirect" ng-click="createRedirect()" class="btn">Create</button>\n\n  <hr />\n\n  <div class="redirects">\n    <ul>\n      <li ng-repeat="r in redirects">\n        <time>{{ r._id | objectIdToDate : \'MM.DD\' }}</time>\n        <label><a href="{{ r.previous }}" target="_blank">{{ r.previous }}</a></label>\n        <span><a href="#" ng-click="deleteRedirect(r._id)">x</a><b>{{ r.type }}</b> {{ r.current }}</span>\n      </li>\n    </ul>\n  </div>\n\n</section>\n'},{}],6:[function(t){"use strict";angular.module("ADMRedirects",["ngRoute","APSvcAdmin","APFilters"]).config(["$locationProvider","$routeProvider",function(e,n){n.when("/v1/adm/redirects",{template:t("./list.html"),controller:"RedirectsCtrl as redirects"})}]).controller("RedirectsCtrl",["$scope","AdmDataService",function(t,e){e.getRedirects(function(e){t.redirects=e}),t.createRedirect=function(){var n={previous:t.previous,current:t.current,type:t.type};e.createRedirect(n,function(e){t.redirects.push(e)})},t.deleteRedirect=function(n){e.deleteRedirect(n,function(){var e=_.find(t.redirects,function(t){return t._id==n});t.redirects=_.without(t.redirects,e)})}}])},{"./list.html":5}],7:[function(t,e){e.exports='<section id="users">\n\n  <br /><br />\n  <input type="text" ng-model="_id" placeholder="Type userId" style="width:300px" />\n  <select ng-model="role">\n    <option>admin</option>\n    <option>editor</option>\n  </select>\n  <button class="btn" ng-click="toggleRole()">Toggle role</button>\n\n\n  <h3>Admins</h3>\n  <ul class="users admin">\n    <li ng-repeat="user in admins">{{ user.name }}</li>\n  </ul>\n\n  <h3>Editors</h3>\n  <ul class="users editors">\n    <li ng-repeat="user in editors">{{ user.name }}</li>\n  </ul>\n\n</section>\n'},{}],8:[function(t){"use strict";angular.module("ADMUsers",["ngRoute","APSvcAdmin","APFilters"]).config(["$locationProvider","$routeProvider",function(e,n){n.when("/v1/adm/users",{template:t("./list.html"),controller:"UsersCtrl as users"})}]).controller("UsersCtrl",["$scope","AdmDataService",function(t,e){t.role="editor",e.getUsersInRole({role:"admin"},function(e){t.admins=e}),e.getUsersInRole({role:"editor"},function(e){t.editors=e}),t.toggleRole=function(){e.toggleRole({_id:t._id,role:t.role},function(){e.getUsersInRole({role:t.role},function(e){t[t.role+"s"]=e})})}}])},{"./list.html":7}],9:[function(t,e){e.exports='<div class="preview">\n  <article class="blogpost">\n    <h1 class="entry-title" itemprop="headline">{{ post.title || "Type post title ..." }}</h1>\n    <h4 id="table-of-contents" ng-if="preview.toc">Table of Contents</h4>\n    <ul id="previewToc" ng-bind-html="preview.toc | markdownHtml"></ul>\n    <figure class="author">\n      <img ng-alt="{{post.by.name}}" ng-src="{{post.by.avatar}}?s=100">\n      <figcaption>\n        {{post.by.bio}}\n      </figcaption>\n    </figure>\n    <p class="asset" ng-bind-html="preview.asset | markdownHtml" ng-if="post.title && post.by.bio"></p>\n    <hr />\n    <div id="body" ng-bind-html="preview.body | markdownHtml"></div>\n  </article>\n</div>\n\n<hr />\n'},{}],10:[function(t){"use strict";angular.module("APPost",[]).directive("apPostListItem",["$parse",function(){return{restrict:"E",template:t("./postListItem.html"),link:function(t,e,n){t.post=t.$eval(n.post)}}}]).directive("apPost",function(){return{template:t("./post.html"),controller:["$scope","$timeout","PostsService",function(t,e){e(function(){pageHlpr.highlightSyntax()},100)}]}})},{"./post.html":9,"./postListItem.html":11}],11:[function(t,e){e.exports='<article itemscope="itemscope" itemtype="http://schema.org/BlogPosting" itemprop="blogPost">\n  <a href="{{ post.url }}" title="{{ post.title }}" target="_self" rel="bookmark">\n    <header class="entry-header">\n      <img class="entry-header-image" itemprop="image" ng-src="{{ post.meta.ogImage }}" align="left" />\n\n      <span class="entry-categories">\n        <em ng-repeat=\'tag in post.tags\'>{{ \'{\'+tag.slug+\'}\' }}</em>\n      </span>\n\n      <p class="entry-meta">\n\n        <span class="entry-author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">\n          <span class="entry-author-name" itemprop="name">{{ post.by.name }}</span>\n          <img class="entry-author-image" itemprop="image" ng-src="{{ post.by.avatar }}?s=50" align="left" />\n          <time class="entry-time" itemprop="datePublished" datetime="{{ post.published }}">{{ post.publishedFormat }}</time>\n\n        </span>\n      </p>\n    </header>\n    <div class="entry-content" itemprop="text">\n      <h2 class="entry-title" itemprop="headline">{{ post.title }}</h2>\n      <p>{{ post.meta.description }}</p>\n\n    </div>\n  </a>\n  <footer class="entry-footer">\n    <bookmarker type="post" object-id="post._id"></bookmarker>\n  </footer>\n</article>\n'},{}],12:[function(t,e){e.exports='<div class="form-group tag-input-group">\n  <div class="nomobile">This feature is not available on mobile</div>\n\n  <div class="drag">\n    <p>\n      <b>drag in order of importance</b>\n      <br />place most used first\n    </p>\n  </div>\n  <div class="selected">\n    <label for="tagInput">Your stack</label>\n\n    <ul class="tags" sortable get=\'tags\' set=\'updateTags\'>\n      <li ng-repeat="tag in tags() | orderBy:\'sort\'" ng-attr-data-id="{{tag._id}}">\n        {{tag.slug}}\n        <a class="remove" ng-click="deselectMatch(tag)">x</a>\n        <a class="order" href="#"></a>\n      </li>\n    </ul>\n\n    <p ng-if="!tags() || tags().length == 0">No tags selected yet.</p>\n  </div>\n\n  <label for="tagInput">Search technologies</label>\n  <input type="text" class="tagInput form-control"\n    placeholder="type a technology (e.g. javascript)"\n    ng-model="q"\n    typeahead="t as t for t in getTags($viewValue) | filter:$viewValue"\n    typeahead-editable="false"\n    typeahead-input-formatter="keypressSelect($model)" tabindex="100"\n    typeahead-template-url="tagMatch.html"\n    >\n  <!-- typeahead-loading="loading"\n  <i ng-show="loading" class="glyphicon glyphicon-refresh"></i>\n   -->\n</div>\n\n<script type="text/ng-template" id="tagMatch.html">\n  <div>\n    <a class="tagSelect">\n      <span bind-html-unsafe="match.model.slug | typeaheadHighlight:query"></span>\n      <p bind-html-unsafe="match.model.desc | typeaheadHighlight:query"></p>\n    </a>\n  </div>\n</script>\n'},{}],13:[function(t){"use strict";angular.module("APTagInput",["ui.bootstrap"]).value("badTagsSearchQuery",function(t){var e=t&&(t.length>=2||/r/i.test(t)),n=/\[|\]|\{|\}/g.test(t),s=!e||n;return angular.element(".tag-input-group").toggleClass("has-error",s),s}).directive("tagInput",["badTagsSearchQuery",function(e){return{restrict:"EA",template:t("./tagInput.html"),scope:{},controller:["$scope","$attrs","$http",function(t,n,s){t.tags=t.$parent.tags,t.selectTag=t.$parent.selectTag,t.deselectTag=t.$parent.deselectTag,t.updateTags=t.$parent.updateTags,t.sortSuccess=t.$parent.sortSuccess,t.sortFail=t.$parent.sortFail,t.templateUrl="tagMatch.html",t.getTags=function(n){return e(n)?[]:(n=encodeURIComponent(n),s.get("/v1/api/tags/search/"+n).then(function(e){var n=[];return angular.forEach(e.data,function(t){n.push(t)}),t.matches=n,n}))},t.keypressSelect=function(e){return e&&0!=t.matches.length?void t.selectMatch(0):null},t.selectMatch=function(e){var n=t.matches[e];t.selectTag(n),t.q=""},t.deselectMatch=function(e){t.deselectTag(e)}}]}}])},{"./tagInput.html":12}],14:[function(t){"use strict";var e=t("../../../shared/util.js");angular.module("APFilters",[]).filter("publishedTime",function(){return function(t,e){var n=moment().format("ZZ");if(""!=t&&null!=t){var s=t.split("GMT")[0],r="MMM Do hh:mm";e&&(r=e);var o=moment(s,"YYYY-MM-DDTHH:mm:ss:SSSZ").format(r);return o.replace(n,"")}return"-"}}).filter("locaTime",function(){return function(t,e){var n=moment().format("ZZ");if(""!=t){var s=t.split("GMT")[0];e=e||"ddd, MMM Do ha";var r=moment(s,"YYYY-MM-DDTHH:mm:ss:SSSZ").format(e);return r.replace(n,"")}return"Confirming time"}}).filter("objectIdToDate",function(){return function(t,n){return n=n||"MMM DD",moment(e.ObjectId2Date(t)).format(n)}}).filter("agoTime",function(){return function(t){return moment(t).fromNow()}}).filter("trustUrl",["$sce",function(t){return function(e){return t.trustAsResourceUrl(e)}}]).filter("markdownHtml",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]).filter("fancyTags",function(){return function(t){return t?t.join(", "):""}})},{"../../../shared/util.js":18}],15:[function(){"use strict";var t=function(t){console.log("error:",t)};angular.module("APSvcAdmin",[]).constant("APIAdm","/v1/api/adm").service("AdmDataService",["$http","APIAdm",function(e,n){this.getPosts=function(s){e.get(n+"/posts").success(s).error(t)},this.getUsersInRole=function(s,r){e.get(n+"/users/role/"+s.role).success(r).error(t)},this.toggleRole=function(s,r){e.put(n+"/users/"+s._id+"/role/"+s.role,s).success(r).error(t)},this.getRedirects=function(s){e.get(n+"/redirects").success(s).error(t)},this.createRedirect=function(s,r){e.post(n+"/redirects",s).success(r).error(t)},this.deleteRedirect=function(s,r){e.delete(n+"/redirects/"+s).success(r).error(t)}}])},{}],16:[function(){"use strict";var t=[],e=function(){};angular.module("APSvcPosts",[]).constant("API","/v1/api").factory("mdHelper",function(){return this.headingsChanged=function(e){var n=t;t=e.match(/\n##.*/g)||[];var s=n.length!=t.length;if(!s)for(var r=0;r<t.length;r++)if(n[r]!=t[r])return!0;return s},this}).service("PostsService",["$http","API","mdHelper",function(t,n,s){this.getById=function(s,r){t.get(n+"/posts/"+s).success(r).error(e)},this.getByUsername=function(s,r){t.get(n+"/posts/by/"+s).success(r).error(e)},this.getMyPosts=function(s){t.get(n+"/posts/me").success(s).error(e)},this.getRecentPosts=function(s){t.get(n+"/posts/recent").success(s).error(e)},this.getTagsPosts=function(s,r){t.get(n+"/posts/tag/"+s).success(r).error(e)},this.getToc=function(r,o){s.headingsChanged(r)&&t.post(n+"/posts-toc",{md:r}).success(o).error(e)},this.create=function(s,r){t.post(n+"/posts",s).success(r).error(e)},this.update=function(s,r){t.put(n+"/posts/"+s._id,s).success(r).error(e)},this.publish=function(s,r){t.put(n+"/posts/publish/"+s._id,s).success(r).error(e)},this.delete=function(s,r){t.delete(n+"/posts/"+s).success(r).error(e)}}])},{}],17:[function(){"use strict";angular.module("APSvcSession",[]).constant("API","/v1/api").constant("Auth","/v1/auth").service("SessionService",["$rootScope","$http","API","Auth","$cacheFactory",function(t,e,n,s,r){var o;this.getSession=function(){return o=o||r(),e.get(n+"/session/full",{cache:o}).then(function(t){return t.data})};var i=function(e){return function(n){t.session=n,e(n)}};this.onAuthenticated=function(t){return this.getSession().then(t)},this.onUnauthenticated=function(t){return this.getSession().then(null,t)},this.flushCache=function(){o=null},this.login=function(t,n,r){e.post(s+"/login",t).success(i(n)).error(r)},this.signup=function(t,n,r){e.post(s+"/signup",t).success(i(n)).error(r)},this.changeEmail=function(t,s,r){e.put(n+"/users/me/email",t).success(i(s)).error(r)},this.verifyEmail=function(t,s,r){e.put(n+"/users/me/email-verify",t).success(i(s)).error(r)},this.updateTag=function(t,s,r){e.put(n+"/users/me/tag/"+t.slug,{}).success(i(s)).error(r)},this.updateBookmark=function(t,s,r){e.put(n+"/users/me/bookmarks/"+t.type+"/"+t.objectId,{}).success(i(s)).error(r)},this.updateProfile=function(t,s,r){e.put(n+"/users/me",t).success(i(s)).error(r)},this.requestPasswordChange=function(t,s,r){e.put(n+"/users/me/password-change",t).success(s).error(r)},this.changePassword=function(t,s,r){e.put(n+"/users/me/password",t).success(s).error(r)},this.tags=function(t,s,r){e.put(n+"/users/me/tags",t).success(s).error(r)},this.bookmarks=function(t,s,r){e.put(n+"/users/me/bookmarks",t).success(s).error(r)}}])},{}],18:[function(t,e){"use strict";var n=/googlebot|gurujibot|twitterbot|yandexbot|slurp|msnbot|bingbot|facebookexternalhit/i,s=function(t,e){return t.toString()==e.toString()},r=function(t,e){if(!t)return null;for(var n,s={},o=e[Symbol.iterator]();!(n=o.next()).done;){var i=n.value,a=i.split(".");if(1===a.length)"undefined"!=typeof t[i]&&null!==t[i]&&(s[i]=t[i]);else{var c=r(t[a[0]],[i.replace(a[0]+".","")]);_.isEmpty(c)||(s[a[0]]=c)}}return s};e.exports={idsEqual:s,ObjectId2Date:function(t){return new Date(1e3*parseInt(t.toString().slice(0,8),16))},toggleItemInArray:function(t,e,n){if(t){n||(n=function(t){return s(t._id,e._id)});var r=_.find(t,n);return r?_.without(t,r):(t.push(e),t)}return[e]},combineItems:function(t,e,n){if(!t&&!e)return[];if(!t||0==t.length)return e;if(!e||0==e.length)return t;for(var r,o=e[Symbol.iterator]();!(r=o.next()).done;){var i=r.value,a=_.find(t,function(t){return s(t[n],i[n])});a||t.push(i)}return t},sessionCreatedAt:function(t){return new moment(t.cookie._expires).subtract(t.cookie.originalMaxAge,"ms").toDate()},dateWithDayAccuracy:function(t){return t||(t=moment()),moment(t.format("YYYY-MM-DD"),"YYYY-MM-DD").toDate()},firstName:function(t){return t.split(" ")[0]},lastName:function(t){return t.replace(t.split(" ")[0]+"","")},selectFromObject:function(t,e){return t&&e?r(t,_.keys(e)):t},isBot:function(t){if(!t)return!0;var e=t.replace(/^\s*/,"").replace(/\s*$/,"");return n.test(e)}}},{}]},{},[1]);