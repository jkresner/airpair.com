<div class="container-fluid stretch" ng-click="lastSeen()">
  <div class="row stretch">

    <div class="col-xs-3 sidebar">
      <form ng-submit="create()">
        <label>Create New Channel</label>
        <input ng-model="name"/>
      </form>

      <div id="channels">
        <label>Active Channels</label>
        <table class="table">
          <tr class="channel" ng-repeat="channel in channels" ng-if="channel.active">
            <td>
              <a ng-click="load(channel.$id)" href="#{{channel.$id}}">{{ channel.name }}</a>&nbsp;<span ng-show="_.keys(notifications[channel.$id]).length > 0">{{ _.keys(notifications[channel.$id]).length }}</span>
            </td>
            <td class="actions"></td>
          </tr>
        </table>
      </div>

      <label>People</label>
      <table class="table">
        <tr class="user" ng-repeat="u in users" ng-class="{active: u.active, away: checkAway(user)}">
          <td class="picture">
            <div class="presence" title="Last active {{moment(u.last_seen).format('dddd, MMMM Do YYYY, h:mm:ss a')}}"></div>
            <img ng-src="{{u.thirdPartyUserData.picture}}"/>
          </td>
          <td>
            <strong>{{ u.displayName }}</strong><br>
            {{ u.thirdPartyUserData.hd }}
          </td>
          <td class="actions">
            <button ng-click="talkWith(u)" ng-if="u.uid != user.uid" title="Start chatting with {{u.displayName}}">
              <i class="fa fa-comment"></i>
            </button>
          </td>
        </tr>
      </table>
      <div ng-hide="user">
        <button ng-click="login()">Login</button>
      </div>
    </div>

    <div class="col-xs-9 stretch">
      <table id="chatroom" class="stretch">
        <tr class="heading"><td><h3>{{ activeChannel.name }}</h3></td></tr>
        <tr id="messages">
          <td>
            <div id="message-cell" scroll-glue="scroll-glue">
              <div ng-repeat="msg in activeMessages" class="row">
                <div class="col-md-1">
                  <div class="from" title="{{msg.from.name}}">
                    <img class="img-responsive" ng-src="{{msg.from.picture}}"/><br>
                    {{ msg.from.first_name }}
                  </div>
                </div>
                <div class="col-md-11">
                  <div class="content">
                    {{ msg.content }}
                    <br>
                    <em class="timestamp" ng-if="msg.sent_at" am-time-ago="msg.sent_at"></em>
                  </div>
                </div>
              </div>
            </div>
          </td>
        </tr>
        <tr id="entry" ng-show="activeChannel && user">
          <td colspan="2">
            <form ng-submit="addMessage()">
              <input id="message" ng-model="message" ng-focus="clearNotifications(activeChannel, user)" placeholder="ask a question"/>
            </form>
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>
